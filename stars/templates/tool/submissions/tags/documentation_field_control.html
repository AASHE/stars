{% load list_access %}
{% load ce_tags %}
{% load submit_tags %}
{% load terms %}

{% if documentation_field.type == 'tabular' %}
	{% if field_form.errors %}
		<div class="alert alert-error">
			Please correct the errors in this table.
		</div>
	{% endif %}
	{% if field_form.form.errors %}
		<div class="alert alert-error">{{ field_form.form.errors.value }}</div>
	{% endif %}
	{% if field_form.form.warnings %}
		<div class="alert alert-warning">{{ field_form.form.warnings }}</div>
	{% endif %}
	<table class="table table-bordered">
		<thead>
			<tr>
				<th></th>
				{% for c in documentation_field.tabular_fields.colHeadings %}
					<th>{{ c }}</th>
				{% endfor %}
			</tr>
		</thead>
		<tbody>
			{% for row in documentation_field.tabular_fields.fields %}
				<tr>
					{% with forloop.counter0 as i %}
						<th>{% get_list_index documentation_field.tabular_fields.rowHeadings i as heading %}{{ heading }}</th>
					{% endwith %}
					{% for col in row %}
						<td>
							{% if field_form.subforms %}
								{% show_submission_field_control field_form.subforms col %}
							{% else %}
								{% show_field_control_from_id col editing %}
							{% endif %}
						</td>
					{% endfor %}
				</tr>
			{% endfor %}
		</tbody>
	</table>
{% else %}
	{{ field_form.value }}
	{% if not field_form.field_includes_units and documentation_field.units %}
                {% if field_form.instance.get_institution.prefers_metric_system %}
                        <span class="help-inline">{{ documentation_field.units.equivalent }}</span>
                {% else %}
                        <span class="help-inline">{{ documentation_field.units }}</span>
                {% endif %}
	{% endif %}
	
	{% if tabular %}
		{% with documentation_field.get_escaped_tooltip_help_text as help_text %}
		    {% with "true" as modal %}
		        {% with documentation_field.id as id %}
		            {% include "helpers/tags/help_text.html" %}
		        {% endwith %}
	        {% endwith %}
	    {% endwith %}
	   	{% if editing %}
			<a href='{{ documentation_field.get_edit_url }}'>
			<i class='icon-edit'></i>
			</a>
		{% endif %}
	{% endif %}
	
	{% if field_form.value.errors %}
		<span class="help-inline">{{ field_form.errors.value }}</span>
	{% endif %}
	{% if field_form.warnings %}
		<span class="help-inline">{{ field_form.warnings }}</span>
	{% endif %}
	
{% endif %}
<p class="help-block">
	<em>{{ documentation_field.inline_help_text|replace_terms }}</em>
</p>
