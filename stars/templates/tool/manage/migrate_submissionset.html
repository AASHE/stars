{% extends 'tool/manage/base.html' %}

{% block crumbs-tool %}
	<li>
		<a href='/tool/submissions/'>{{ active_submission.creditset.version }}</a>
		<span class="divider">/</span>
	</li>
	<li>Migrate</li>
{% endblock %}

{% block tabs %}
	{% with active_tab="migrate" %}{{ block.super }}{% endwith %}
{% endblock %}

{% block institution_content %}

	<div class='row'>
		<div class='span4'>
			<h3>Version Migration</h3>
			<p>Migrate Submission to <strong>{{ latest_creditset }}</strong>.</p>
			{% if active_submission.creditset != latest_creditset %} 
				<a href="#" class='btn btn-primary'>Migrate Now</a>
			{% else %}
				<div class="alert alert-success">
					You are already working in <strong>{{ latest_creditset }}</strong>.
				</div>
			{% endif %}
		</div>
		<div class='span4 offset1'>
			<h3>Data Migration</h3>
			<p>Pull data from previous Reports, Snapshots, and incomplete Submissions.</p>
			{% if available_submissions %}
				<table class='table'>
					<thead>
						<tr>
							<th>Date</th>
							<th>Type</th>
						</tr>
					</thead>
					<tbody>
						{% for sub in available_submissions %}
							<td>
								{% if sub.date_submitted %}
									{{ sub.date_submitted }}
								{% else %}
									{{ sub.date_registered }}
								{% endif %}
							</td>
							<td>
								{% if sub.status == 'f' %}
									Snapshot
								{% else %}{% if sub.status == "r" %}
									Report
								{% else %}
									Unpublished
								{% endif %}{% endif %}
							</td>
						{% endfor %}
					</tbody>
				</table>
			{% else %}
				<div class="alert">
					No currently available submissions.
				</div>
			{% endif %}
		</div>
	</div>
{% endblock %}
