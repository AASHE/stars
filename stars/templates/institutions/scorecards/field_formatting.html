{% load humanize %}
{% load report_tags %}
{% load logical_rules_tags %}
{% load help %}
{% load l10n %}

{% if not field.is_empty %}
	{% ifequal field.documentation_field.type 'long_text' %}
	    <div style='text-align: left; margin: 0px;padding: 0px;'>
		    {% block long_text_disply %}{{ field.value|urlize|linebreaks|fix_ampersands }}{% endblock %}
		</div>
	{% else %}
	    {% ifequal field.documentation_field.type 'url' %}
	        {% block url_display %}<a href='{{ field.value }}' target="_blank">{{ field.value }}</a>{% endblock %}
	    {% else %}
	        {% ifequal field.documentation_field.type 'upload' %}
	            {% if field.value %}
	                <a href='{% if host %}http://{{ host }}{% endif %}{{ field.value.url }}'>{{ field.get_filename }}</a>
	            {% endif %}
	        {% else %}
	            {% ifequal field.documentation_field.type 'numeric' %}
	                {{ field.value|floatformat:"-2" }}
	                {% if field.documentation_field.units %}
	                    <i>{{ field.documentation_field.units }}</i>
	                {% endif %}
	            {% else %}
	                {% ifequal field.documentation_field.type 'boolean' %}
	                    {{ field }}
	                {% else %}
	                    {{ field.value }}
	                {% endifequal %}
	            {% endifequal %}
	        {% endifequal %}
	    {% endifequal %}
	{% endifequal %}
{% else %}
	<span class='green'>---</span>
{% endif %}

{% if not pdf and not preview %}

	{% if field.flags %}
	   	{% for f in field.flags %}
	   		<a 	href="{% if user.is_staff %}{{ f.get_admin_url }}{% else %}#{% endif %}"
		    	rel="tooltip"
                data-toggle="tooltip"
		    	id="flag_{{ f.id|unlocalize }}"
		    	title="{{ f.description }}"
		    	class='pull-right'>
	    		<i class='icon-flag'> </i></a>
	    	<script type='text/javascript'>$('#flag_{{ f.id|unlocalize }}').tooltip({'html': true});</script>
	  	{% endfor %}
	  {% endif %}
	{% if user.is_staff %}
		<a href="{{ field.get_flag_url }}" class='btn btn-mini pull-right'><i class='icon-flag'></i></a>
	{% endif %}
  
	{% testrule user_is_institution_admin user institution %}
	    <a 	href="{{ field.get_correction_url }}"
	    	class='btn btn-mini pull-right'
            data-toggle="tooltip"
	    	id="dc_{{ field.id|unlocalize }}"
	    	title="{% get_help_context 'data_correction_popup' %}">
	    		<i class='icon-pencil'> </i></a>
	    <script type='text/javascript'>
	    	var options = {'html': true}
	    	$('#dc_{{ field.id|unlocalize }}').tooltip(options);
	    </script>
	{% endtestrule %}
{% endif %}
